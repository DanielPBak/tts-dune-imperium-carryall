{
  "SaveName": "",
  "Date": "",
  "VersionNumber": "",
  "GameMode": "",
  "GameType": "",
  "GameComplexity": "",
  "Tags": [],
  "Gravity": 0.5,
  "PlayArea": 0.5,
  "Table": "",
  "Sky": "",
  "Note": "",
  "TabStates": {},
  "LuaScript": "",
  "LuaScriptState": "",
  "XmlUI": "",
  "ObjectStates": [
    {
      "GUID": "1fa213",
      "Name": "Custom_Model",
      "Transform": {
        "posX": 12.0,
        "posY": 0.0,
        "posZ": -18.0,
        "rotX": 277.98996,
        "rotY": 285.030029,
        "rotZ": 179.969955,
        "scaleX": 0.1,
        "scaleY": 0.1,
        "scaleZ": 0.1
      },
      "Nickname": "",
      "Description": "",
      "GMNotes": "",
      "AltLookAngle": {
        "x": 0.0,
        "y": 0.0,
        "z": 0.0
      },
      "ColorDiffuse": {
        "r": 0.562717557,
        "g": 0.5141084,
        "b": 0.0598005131
      },
      "LayoutGroupSortIndex": 0,
      "Value": 0,
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "IgnoreFoW": false,
      "MeasureMovement": false,
      "DragSelectable": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomMesh": {
        "MeshURL": "file:///C:\\Users\\mark\\Desktop\\tts\\Sand Worm.obj",
        "DiffuseURL": "",
        "NormalURL": "",
        "ColliderURL": "",
        "Convex": true,
        "MaterialIndex": 0,
        "TypeIndex": 1,
        "CastShadows": true
      },
      "LuaScript": "RED_VP_TRAY = \"e0ed4b\"\r\nGREEN_VP_TRAY = \"caaba4\"\r\nYELLOW_VP_TRAY = \"99a860\"\r\nBLUE_VP_TRAY = \"121bb6\"\r\n\r\nfunction onLoad()\r\n    self.setScale({0.10, 0.10, 0.10})\r\n    self.setRotation({277.99, 285.03, 179.97})\r\n    self.setPosition({12, 0, -18})\r\n    self.setLock(true)\r\n\r\n    UI.setXml([[\r\n<Defaults>\r\n    <Panel class=\"Window\" width=\"1024\" height=\"600\" color=\"#222222ff\" allowDragging=\"True\"\r\n        returnToOriginalPositionWhenReleased=\"false\" outline=\"#404040\"/>\r\n    <Button fontSize=\"20\" width=\"20\" height=\"10\" color=\"#449944\" textColor=\"#eeeeee\"/>\r\n    <Text alignment=\"MiddleCenter\" fontSize=\"20\" color=\"white\"/>\r\n    <Cell class=\"c2\" alignment=\"MiddleCenter\" fontSize=\"20\" color=\"#223322\"/>\r\n</Defaults>\r\n\r\n<Panel class=\"Window\" id=\"Window\">\r\n        <TableLayout>\r\n        <Row>\r\n            <Cell><Panel color=\"#662222\"><Text>rank</Text></Panel></Cell>\r\n            <Cell><Panel color=\"#662222\"><Text>color</Text></Panel></Cell>\r\n            <Cell><Panel color=\"#662222\"><Text>points</Text></Panel></Cell>\r\n            <Cell><Panel color=\"#662222\"><Text>steam name</Text></Panel></Cell>\r\n            <Cell><Panel color=\"#662222\"><Text>steam id</Text></Panel></Cell>\r\n        </Row>\r\n        <Row>\r\n            <Cell><Panel color=\"#222266\"><Text>1st</Text></Panel></Cell>\r\n            <Cell><Text id=\"color1\"></Text></Cell>\r\n            <Cell><Text id=\"points1\"></Text></Cell>\r\n            <Cell><Text id=\"name1\"></Text></Cell>\r\n            <Cell><Text id=\"id1\"></Text></Cell>\r\n        </Row>\r\n        <Row>\r\n            <Cell><Panel color=\"#222266\"><Text>2nd</Text></Panel></Cell>\r\n            <Cell><Text id=\"color2\"></Text></Cell>\r\n            <Cell><Text id=\"points2\"></Text></Cell>\r\n            <Cell><Text id=\"name2\"></Text></Cell>\r\n            <Cell><Text id=\"id2\"></Text></Cell></Row>\r\n        <Row>\r\n            <Cell><Panel color=\"#222266\"><Text>3rd</Text></Panel></Cell>\r\n            <Cell><Text id=\"color3\"></Text></Cell>\r\n            <Cell><Text id=\"points3\"></Text></Cell>\r\n            <Cell><Text id=\"name3\"></Text></Cell>\r\n            <Cell><Text id=\"id3\"></Text></Cell>\r\n        </Row>\r\n        <Row>\r\n            <Cell><Panel color=\"#222266\"><Text>4th</Text></Panel></Cell>\r\n            <Cell><Text id=\"color4\"></Text></Cell>\r\n            <Cell><Text id=\"points4\"></Text></Cell>\r\n            <Cell><Text id=\"name4\"></Text></Cell>\r\n            <Cell><Text id=\"id4\"></Text></Cell>\r\n        </Row>\r\n        <Row>\r\n            <Cell/><Cell/><Cell/>\r\n            <Cell><Button id=\"fetch\" text=\"Fetch Results\" onClick=\"1fa213/reportResults\"/></Cell>\r\n            <Cell><Button id=\"submit\" text=\"Submit!\" onClick=\"1fa213/sendForm\"/></Cell>\r\n        </Row>\r\n    </TableLayout>\r\n</Panel>\r\n]])\r\n    reportResults()\r\nend\r\n\r\nfunction formCallback(request)\r\n    if request.is_error then\r\n        print('there was an error!')\r\n        print(request.text)\r\n        log(request.text)\r\n    else\r\n        print('form was submitted successfully')\r\n    end\r\nend\r\n\r\nfunction sendForm()\r\n    local infoTable = {\r\n        [\"entry.1770843937\"] = UI.getAttribute(\"name1\", \"text\"),\r\n        [\"entry.826495039\"] = UI.getAttribute(\"name2\", \"text\"),\r\n        [\"entry.179618972\"] = UI.getAttribute(\"name3\", \"text\"),\r\n        [\"entry.1402940149\"] = UI.getAttribute(\"name4\", \"text\")\r\n    }\r\n    WebRequest.post(\"https://docs.google.com/forms/u/0/d/e/1FAIpQLSfD6MTMYaUKEYZy659HqRUdhBKqbvjFOeldII-qmXqrZQkMSw/formResponse\",\r\n    infoTable, formCallback)\r\nend\r\n\r\nfunction reportResults()\r\n    print(\"reporting results\")\r\n    results = { }\r\n    local allPlayers = Player.getPlayers()\r\n    local tray = \"\"\r\n    for _, player in ipairs(allPlayers) do\r\n        if player.seated then\r\n            tray = \"\"\r\n            if player.color == \"Red\" then tray = RED_VP_TRAY\r\n            elseif player.color == \"Blue\" then tray = BLUE_VP_TRAY\r\n            elseif player.color == \"Yellow\" then tray = YELLOW_VP_TRAY\r\n            elseif player.color == \"Green\" then tray = GREEN_VP_TRAY\r\n            end\r\n            if tray != \"\" then\r\n                table.insert(results, { player.color, getObjectFromGUID(tray).call(\"getScore\") - 1,\r\n                    player.steam_name, player.steam_id } )\r\n            end\r\n        end\r\n    end\r\n    table.sort(results, function (left, right) return left[2] > right[2] end)\r\n\r\n    if #results < 1 then return end\r\n    UI.setAttribute(\"color1\", \"text\", results[1][1])\r\n    UI.setAttribute(\"points1\", \"text\", results[1][2])\r\n    UI.setAttribute(\"name1\", \"text\", results[1][3])\r\n    UI.setAttribute(\"id1\", \"text\", results[1][4])\r\n\r\n    if #results < 2 then return end\r\n    UI.setAttribute(\"color2\", \"text\", results[2][1])\r\n    UI.setAttribute(\"points2\", \"text\", results[2][2])\r\n    UI.setAttribute(\"name2\", \"text\", results[2][3])\r\n    UI.setAttribute(\"id2\", \"text\", results[2][4])\r\n\r\n    if #results < 3 then return end\r\n    UI.setAttribute(\"color3\", \"text\", results[3][1])\r\n    UI.setAttribute(\"points3\", \"text\", results[3][2])\r\n    UI.setAttribute(\"name3\", \"text\", results[3][3])\r\n    UI.setAttribute(\"id3\", \"text\", results[3][4])\r\n\r\n    if #results < 4 then return end\r\n    UI.setAttribute(\"color4\", \"text\", results[4][1])\r\n    UI.setAttribute(\"points4\", \"text\", results[4][2])\r\n    UI.setAttribute(\"name4\", \"text\", results[4][3])\r\n    UI.setAttribute(\"id4\", \"text\", results[4][4])\r\nend\r\n",
      "LuaScriptState": "",
      "XmlUI": ""
    }
  ]
}
