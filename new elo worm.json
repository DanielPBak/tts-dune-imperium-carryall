{
  "SaveName": "",
  "Date": "",
  "VersionNumber": "",
  "GameMode": "",
  "GameType": "",
  "GameComplexity": "",
  "Tags": [],
  "Gravity": 0.5,
  "PlayArea": 0.5,
  "Table": "",
  "Sky": "",
  "Note": "",
  "TabStates": {},
  "LuaScript": "",
  "LuaScriptState": "",
  "XmlUI": "",
  "ObjectStates": [
    {
      "GUID": "0c5b68",
      "Name": "Custom_Model",
      "Transform": {
        "posX": 5.91,
        "posY": -39.39,
        "posZ": -69.69,
        "rotX": 0.0,
        "rotY": 89.66,
        "rotZ": 0.0,
        "scaleX": 0.4,
        "scaleY": 0.4,
        "scaleZ": 0.4
      },
      "Nickname": "new elo worm",
      "Description": "",
      "GMNotes": "",
      "AltLookAngle": {
        "x": 0.0,
        "y": 0.0,
        "z": 0.0
      },
      "ColorDiffuse": {
        "r": 0.9285714,
        "g": 0.652909756,
        "b": 0.06632625
      },
      "LayoutGroupSortIndex": 0,
      "Value": 0,
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "IgnoreFoW": false,
      "MeasureMovement": false,
      "DragSelectable": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomMesh": {
        "MeshURL": "http://cloud-3.steamusercontent.com/ugc/1912366352051543759/D9D1138C90F14341F26DF28D37C0FD5A320F711E/",
        "DiffuseURL": "",
        "NormalURL": "",
        "ColliderURL": "",
        "Convex": true,
        "MaterialIndex": 0,
        "TypeIndex": 0,
        "CastShadows": true
      },
      "LuaScript": "ressources = { }\r\nresults = { }\r\n\r\nfunction onLoad()\r\n    self.setScale({0.40, 0.40, 0.40})\r\n    self.setRotation({0.00, 89.66, 0.00})\r\n    self.setPosition({5.91, -39.39, -69.69})\r\n    self.setLock(true)\r\n    self.interactable = true\r\n\r\n    ressources[\"Red\"] = { }\r\n    ressources[\"Green\"] = { }\r\n    ressources[\"Yellow\"] = { }\r\n    ressources[\"Blue\"] = { }\r\n\r\n    ressources[\"Red\"][\"vptray\"] = getObjectFromGUID(\"e0ed4b\")\r\n    ressources[\"Green\"][\"vptray\"] = getObjectFromGUID(\"caaba4\")\r\n    ressources[\"Yellow\"][\"vptray\"] = getObjectFromGUID(\"99a860\")\r\n    ressources[\"Blue\"][\"vptray\"] = getObjectFromGUID(\"121bb6\")\r\n\r\n    ressources[\"Red\"][\"épices\"] = getObjectFromGUID(\"3074d4\")\r\n    ressources[\"Green\"][\"épices\"] = getObjectFromGUID(\"9cc286\")\r\n    ressources[\"Yellow\"][\"épices\"] = getObjectFromGUID(\"22478f\")\r\n    ressources[\"Blue\"][\"épices\"] = getObjectFromGUID(\"78fb8a\")\r\n\r\n    ressources[\"Red\"][\"solari\"] = getObjectFromGUID(\"576ccd\")\r\n    ressources[\"Green\"][\"solari\"] = getObjectFromGUID(\"fa5236\")\r\n    ressources[\"Yellow\"][\"solari\"] = getObjectFromGUID(\"e597dc\")\r\n    ressources[\"Blue\"][\"solari\"] = getObjectFromGUID(\"c5c4ef\")\r\n\r\n    ressources[\"Red\"][\"eau\"] = getObjectFromGUID(\"692c4d\")\r\n    ressources[\"Green\"][\"eau\"] = getObjectFromGUID(\"0afaeb\")\r\n    ressources[\"Yellow\"][\"eau\"] = getObjectFromGUID(\"fa9522\")\r\n    ressources[\"Blue\"][\"eau\"] = getObjectFromGUID(\"f217d0\")\r\n\r\n    ressources[\"Red\"][\"leader\"] = getObjectFromGUID(\"66cdbb\")\r\n    ressources[\"Green\"][\"leader\"] = getObjectFromGUID(\"cf1486\")\r\n    ressources[\"Yellow\"][\"leader\"] = getObjectFromGUID(\"a677e0\")\r\n    ressources[\"Blue\"][\"leader\"] = getObjectFromGUID(\"681774\")\r\n\r\n    UI.setXml([[\r\n<Defaults>\r\n    <Panel class=\"Window\" width=\"950\" height=\"400\" color=\"#222222ff\" allowDragging=\"True\"\r\n        returnToOriginalPositionWhenReleased=\"false\" outline=\"#404040\"/>\r\n    <Panel class=\"header\" color=\"orange\"/>\r\n    <Panel class=\"red\" color=\"#aa2222\"/>\r\n    <Panel class=\"green\" color=\"#228822\"/>\r\n    <Panel class=\"yellow\" color=\"#aaaa22\"/>\r\n    <Panel class=\"blue\" color=\"#2222aa\"/>\r\n    <Panel class=\"purple2\" color=\"#800080\"/>\r\n    <Text fontSize=\"20\" color=\"white\"/>\r\n    <InputField onValueChanged=\"]]..self.guid..[[/changeValue\" characterValidation=\"Integer\" textColor=\"black\" text=\"0\" fontSize=\"20\" alignment=\"MiddleCenter\"/>\r\n    <InputField class=\"red2\" color=\"#cc4444\"/>\r\n    <InputField class=\"green2\" color=\"#44aa44\"/>\r\n    <InputField class=\"yellow2\" color=\"#cccc44\"/>\r\n    <InputField class=\"blue2\" color=\"#4444cc\"/>\r\n    <Button textColor=\"white\" fontSize=\"20\"/>\r\n</Defaults>\r\n\r\n<Panel class=\"Window\" id=\"Window\">\r\n    <TableLayout>\r\n        <Row>\r\n            <Cell><Panel class=\"header\"><Text>PLAYER</Text></Panel></Cell>\r\n            <Cell><Panel class=\"header\"><Text>LEADER</Text></Panel></Cell>\r\n            <Cell><Panel class=\"header\"><Text>RANK</Text></Panel></Cell>\r\n            <Cell><Panel class=\"header\"><Text>VPs</Text></Panel></Cell>\r\n            <Cell><Panel class=\"header\"><Text>SPICE</Text></Panel></Cell>\r\n            <Cell><Panel class=\"header\"><Text>SOLARI</Text></Panel></Cell>\r\n            <Cell><Panel class=\"header\"><Text>WATER</Text></Panel></Cell>\r\n        </Row>\r\n        <Row>\r\n            <Cell><Panel class=\"red\"><Text id=\"name_red\"></Text></Panel></Cell>\r\n            <Cell><Panel class=\"red\"><Text id=\"leader_red\"></Text></Panel></Cell>\r\n            <Cell><InputField class=\"red2\" id=\"rank_red\"/></Cell>\r\n            <Cell><InputField class=\"red2\" id=\"points_red\"/></Cell>\r\n            <Cell><InputField class=\"red2\" id=\"spice_red\"/></Cell>\r\n            <Cell><InputField class=\"red2\" id=\"solari_red\"/></Cell>\r\n            <Cell><InputField class=\"red2\" id=\"water_red\"/></Cell>\r\n        </Row>\r\n        <Row>\r\n            <Cell><Panel class=\"green\"><Text id=\"name_green\"></Text></Panel></Cell>\r\n            <Cell><Panel class=\"green\"><Text id=\"leader_green\"></Text></Panel></Cell>\r\n            <Cell><InputField class=\"green2\" id=\"rank_green\"/></Cell>\r\n            <Cell><InputField class=\"green2\" id=\"points_green\"/></Cell>\r\n            <Cell><InputField class=\"green2\" id=\"spice_green\"/></Cell>\r\n            <Cell><InputField class=\"green2\" id=\"solari_green\"/></Cell>\r\n            <Cell><InputField class=\"green2\" id=\"water_green\"/></Cell>\r\n        </Row>\r\n        <Row>\r\n            <Cell><Panel class=\"yellow\"><Text id=\"name_yellow\"></Text></Panel></Cell>\r\n            <Cell><Panel class=\"yellow\"><Text id=\"leader_yellow\"></Text></Panel></Cell>\r\n            <Cell><InputField class=\"yellow2\" id=\"rank_yellow\"/></Cell>\r\n            <Cell><InputField class=\"yellow2\" id=\"points_yellow\"/></Cell>\r\n            <Cell><InputField class=\"yellow2\" id=\"spice_yellow\"/></Cell>\r\n            <Cell><InputField class=\"yellow2\" id=\"solari_yellow\"/></Cell>\r\n            <Cell><InputField class=\"yellow2\" id=\"water_yellow\"/></Cell>\r\n        </Row>\r\n        <Row>\r\n            <Cell><Panel class=\"blue\"><Text id=\"name_blue\"></Text></Panel></Cell>\r\n            <Cell><Panel class=\"blue\"><Text id=\"leader_blue\"></Text></Panel></Cell>\r\n            <Cell><InputField class=\"blue2\" id=\"rank_blue\"/></Cell>\r\n            <Cell><InputField class=\"blue2\" id=\"points_blue\"/></Cell>\r\n            <Cell><InputField class=\"blue2\" id=\"spice_blue\"/></Cell>\r\n            <Cell><InputField class=\"blue2\" id=\"solari_blue\"/></Cell>\r\n            <Cell><InputField class=\"blue2\" id=\"water_blue\"/></Cell>\r\n        </Row>\r\n        <Row>\r\n            <Cell><Button id=\"close\" color=\"purple\" text=\"Close\" onClick=\"]]..self.guid..[[/close\"/></Cell>\r\n            <Cell><Panel class=\"purple2\"/></Cell>\r\n            <Cell><Panel class=\"purple2\"/></Cell>\r\n            <Cell><Panel class=\"purple2\"/></Cell>\r\n            <Cell><Panel class=\"purple2\"/></Cell>\r\n            <Cell><Button id=\"fetch\" color=\"purple\" text=\"Refresh Results\" onClick=\"]]..self.guid..[[/reportResults\"/></Cell>\r\n            <Cell><Button id=\"submit\" color=\"purple\" text=\"Submit!\" onClick=\"]]..self.guid..[[/sendForm\"/></Cell>\r\n        </Row>\r\n    </TableLayout>\r\n</Panel>\r\n]])\r\n    reportResults()\r\nend\r\n\r\nfunction changeValue(player, value, element)\r\n    UI.setAttribute(element, \"text\", value)\r\nend\r\n\r\nfunction close()\r\n    UI.setXml(\"\")\r\nend\r\n\r\nfunction formCallback(request)\r\n    if request.is_error then\r\n        broadcastToAll('there was an error!')\r\n        broadcastToAll(request.text)\r\n    else\r\n        broadcastToAll('form was submitted successfully')\r\n        UI.setAttribute(\"submit\", \"interactable\", \"false\")\r\n        UI.setAttribute(\"submit\", \"color\", \"purple\")\r\n        UI.setAttribute(\"submit\", \"textColor\", \"yellow\")\r\n        UI.setAttribute(\"submit\", \"text\", \"SUCCESS!\")\r\n    end\r\nend\r\n\r\nfunction sendForm(submitter)\r\n    local conflictCardZone = getObjectFromGUID('07e239')\r\n    local conflictCards = conflictCardZone.getObjects()[1]\r\n    local round = 10\r\n    if conflictCards ~= nil then\r\n        if conflictCards.tag == 'Deck' then\r\n            local cards = conflictCards.getObjects()\r\n            round = 10 - #cards\r\n        elseif conflictCards.tag == 'Card' then\r\n            round = 9\r\n        end\r\n    end\r\n    local infoTable = {\r\n        [\"entry.2126893034\"] = \"1\", --is_ranked\r\n        [\"entry.1195859029\"] = submitter.steam_id, --submitter_steam_id\r\n        [\"entry.980559040\"] = submitter.steam_name, --submitter_steam_name\r\n        [\"entry.779373663\"] = \"game start timestamp\", --game_start_timestamp\r\n        [\"entry.234195300\"] = round, --n_rounds\r\n\r\n        -- p1 is RED\r\n        --UI.getAttribute(\"id_red\", \"text\")\r\n        [\"entry.82402215\"] = results[\"Red\"][\"id\"], --p1_steam_id\r\n        [\"entry.1635429235\"] = UI.getAttribute(\"name_red\", \"text\"), --p1_steam_name\r\n        [\"entry.419710564\"] = UI.getAttribute(\"rank_red\", \"text\"), --p1_placement\r\n        [\"entry.1878523358\"] = UI.getAttribute(\"points_red\", \"text\"), --p1_total_vps\r\n        [\"entry.1073272736\"] = \"\", --p1_vps_list\r\n        [\"entry.178708796\"] = UI.getAttribute(\"spice_red\", \"text\"), --p1_spice\r\n        [\"entry.312713987\"] = UI.getAttribute(\"solari_red\", \"text\"), --p1_solari\r\n        [\"entry.377801515\"] = UI.getAttribute(\"water_red\", \"text\"), --p1_water\r\n        [\"entry.1566289571\"] = \"\", --p1_chamurky\r\n        [\"entry.220375463\"] = \"\", --p1_startpos\r\n        [\"entry.565786681\"] = UI.getAttribute(\"leader_red\", \"text\"), --p1_leader\r\n\r\n        -- p2 is GREEN\r\n        --UI.getAttribute(\"id_green\", \"text\")\r\n        [\"entry.926384740\"] = results[\"Green\"][\"id\"], --p2_steam_id\r\n        [\"entry.8189124\"] = UI.getAttribute(\"name_green\", \"text\"), --p2_steam_name\r\n        [\"entry.829300525\"] = UI.getAttribute(\"rank_green\", \"text\"), --p2_placement\r\n        [\"entry.1498362639\"] = UI.getAttribute(\"points_green\", \"text\"), --p2_total_vps\r\n        [\"entry.1338086196\"] = \"\", --p2_vps_list\r\n        [\"entry.2112800604\"] = UI.getAttribute(\"spice_green\", \"text\"), --p2_spice\r\n        [\"entry.97230832\"] = UI.getAttribute(\"solari_green\", \"text\"), --p2_solari\r\n        [\"entry.1615516743\"] = UI.getAttribute(\"water_green\", \"text\"), --p2_water\r\n        [\"entry.431493524\"] = \"\", --p2_chamurky\r\n        [\"entry.516704953\"] = \"\", --p2_startpos\r\n        [\"entry.126177821\"] = UI.getAttribute(\"leader_green\", \"text\"), --p2_leader\r\n\r\n        -- p3 is YELLOW\r\n        --UI.getAttribute(\"id_yellow\", \"text\")\r\n        [\"entry.1056344986\"] = results[\"Yellow\"][\"id\"], --p3_steam_id\r\n        [\"entry.1000335964\"] = UI.getAttribute(\"name_yellow\", \"text\"), --p3_steam_name\r\n        [\"entry.1815125303\"] = UI.getAttribute(\"rank_yellow\", \"text\"), --p3_placement\r\n        [\"entry.1006025268\"] = UI.getAttribute(\"points_yellow\", \"text\"), --p3_total_vps\r\n        [\"entry.405019323\"] = \"\", --p3_vps_list\r\n        [\"entry.1485294161\"] = UI.getAttribute(\"spice_yellow\", \"text\"), --p3_spice\r\n        [\"entry.1960273034\"] = UI.getAttribute(\"solari_yellow\", \"text\"), --p3_solari\r\n        [\"entry.2103268491\"] = UI.getAttribute(\"water_yellow\", \"text\"), --p3_water\r\n        [\"entry.1546563705\"] = \"\", --p3_chamurky\r\n        [\"entry.1730389595\"] = \"\", --p3_startpos\r\n        [\"entry.555758857\"] = UI.getAttribute(\"leader_yellow\", \"text\"), --p3_leader\r\n\r\n        -- p4 is BLUE\r\n        --UI.getAttribute(\"id_blue\", \"text\")\r\n        [\"entry.724137382\"] = results[\"Blue\"][\"id\"], --p4_steam_id\r\n        [\"entry.79132597\"] = UI.getAttribute(\"name_blue\", \"text\"), --p4_steam_name\r\n        [\"entry.1095237101\"] = UI.getAttribute(\"rank_blue\", \"text\"), --p4_placement\r\n        [\"entry.1786102321\"] = UI.getAttribute(\"points_blue\", \"text\"), --p4_total_vps\r\n        [\"entry.654442789\"] = \"\", --p4_vps_list\r\n        [\"entry.1200193803\"] = UI.getAttribute(\"spice_blue\", \"text\"), --p4_spice\r\n        [\"entry.848733094\"] = UI.getAttribute(\"solari_blue\", \"text\"), --p4_solari\r\n        [\"entry.767203598\"] = UI.getAttribute(\"water_blue\", \"text\"), --p4_water\r\n        [\"entry.2048085041\"] = \"\", --p4_chamurky\r\n        [\"entry.1751147952\"] = \"\", --p4_startpos\r\n        [\"entry.850152509\"] = UI.getAttribute(\"leader_blue\", \"text\"), --p4_leader\r\n    }\r\n    WebRequest.post(\"https://docs.google.com/forms/u/0/d/e/1FAIpQLScGit6kyKI_5It9aZAM82KNCBQ4RC0dQWxNA4DDwgj3z05zKA/formResponse\",\r\n        infoTable, formCallback)\r\nend\r\n\r\nfunction allGood(player)\r\n    if not player.seated then\r\n        return false\r\n    end\r\n\r\n    local color = player.color\r\n    if color == \"Red\" or color == \"Green\" or color == \"Yellow\" or color == \"Blue\" then\r\n        return true\r\n    else\r\n        return false\r\n    end\r\nend\r\n\r\nfunction reportResults()\r\n    local playerCount = 0\r\n    if results == nil then results = { } end\r\n    for _, player in ipairs(Player.getPlayers()) do\r\n        if allGood(player) then\r\n            local color = player.color\r\n            results[color] = { }\r\n            results[color][\"rank\"] = -1\r\n            results[color][\"points\"] = ressources[color][\"vptray\"].call(\"getScore\") - 1\r\n            results[color][\"color\"] = color\r\n            results[color][\"name\"] = player.steam_name\r\n            results[color][\"leader\"] = ressources[color][\"leader\"].getObjects()[1].getName()\r\n            results[color][\"spice\"] = ressources[color][\"épices\"].call(\"collectVal\")\r\n            results[color][\"solari\"] = ressources[color][\"solari\"].call(\"collectVal\")\r\n            results[color][\"water\"] = ressources[color][\"eau\"].call(\"collectVal\")\r\n            results[color][\"id\"] = player.steam_id\r\n            playerCount = playerCount + 1\r\n        end\r\n    end\r\n\r\n    if playerCount < 4 then\r\n        if playerCount > 0 then\r\n            broadcastToAll(\"not enough players!\")\r\n        end\r\n        return\r\n    end\r\n\r\n    -- tables can't be sorted so we copy the values into an array\r\n    local sortedResults = { }\r\n    for _, value in pairs(results) do\r\n        table.insert(sortedResults, value)\r\n    end\r\n    table.sort(sortedResults, function (left, right) return left[\"points\"] > right[\"points\"] end)\r\n\r\n    -- now we can extract the rankings\r\n    for rank, value in pairs(sortedResults) do\r\n        results[value[\"color\"]][\"rank\"] = rank\r\n    end\r\n\r\n    UI.setAttribute(\"points_red\", \"text\", results[\"Red\"][\"points\"])\r\n    UI.setAttribute(\"name_red\", \"text\", results[\"Red\"][\"name\"])\r\n    UI.setAttribute(\"id_red\", \"text\", results[\"Red\"][\"id\"])\r\n    UI.setAttribute(\"rank_red\", \"text\", results[\"Red\"][\"rank\"])\r\n    UI.setAttribute(\"leader_red\", \"text\", results[\"Red\"][\"leader\"])\r\n    UI.setAttribute(\"spice_red\", \"text\", results[\"Red\"][\"spice\"])\r\n    UI.setAttribute(\"solari_red\", \"text\", results[\"Red\"][\"solari\"])\r\n    UI.setAttribute(\"water_red\", \"text\", results[\"Red\"][\"water\"])\r\n\r\n    UI.setAttribute(\"points_green\", \"text\", results[\"Green\"][\"points\"])\r\n    UI.setAttribute(\"name_green\", \"text\", results[\"Green\"][\"name\"])\r\n    UI.setAttribute(\"id_green\", \"text\", results[\"Green\"][\"id\"])\r\n    UI.setAttribute(\"rank_green\", \"text\", results[\"Green\"][\"rank\"])\r\n    UI.setAttribute(\"leader_green\", \"text\", results[\"Green\"][\"leader\"])\r\n    UI.setAttribute(\"spice_green\", \"text\", results[\"Green\"][\"spice\"])\r\n    UI.setAttribute(\"solari_green\", \"text\", results[\"Green\"][\"solari\"])\r\n    UI.setAttribute(\"water_green\", \"text\", results[\"Green\"][\"water\"])\r\n\r\n    UI.setAttribute(\"points_yellow\", \"text\", results[\"Yellow\"][\"points\"])\r\n    UI.setAttribute(\"name_yellow\", \"text\", results[\"Yellow\"][\"name\"])\r\n    UI.setAttribute(\"id_yellow\", \"text\", results[\"Yellow\"][\"id\"])\r\n    UI.setAttribute(\"rank_yellow\", \"text\", results[\"Yellow\"][\"rank\"])\r\n    UI.setAttribute(\"leader_yellow\", \"text\", results[\"Yellow\"][\"leader\"])\r\n    UI.setAttribute(\"spice_yellow\", \"text\", results[\"Yellow\"][\"spice\"])\r\n    UI.setAttribute(\"solari_yellow\", \"text\", results[\"Yellow\"][\"solari\"])\r\n    UI.setAttribute(\"water_yellow\", \"text\", results[\"Yellow\"][\"water\"])\r\n\r\n    UI.setAttribute(\"points_blue\", \"text\", results[\"Blue\"][\"points\"])\r\n    UI.setAttribute(\"name_blue\", \"text\", results[\"Blue\"][\"name\"])\r\n    UI.setAttribute(\"leader_blue\", \"text\", results[\"Blue\"][\"leader\"])\r\n    UI.setAttribute(\"id_blue\", \"text\", results[\"Blue\"][\"id\"])\r\n    UI.setAttribute(\"rank_blue\", \"text\", results[\"Blue\"][\"rank\"])\r\n    UI.setAttribute(\"spice_blue\", \"text\", results[\"Blue\"][\"spice\"])\r\n    UI.setAttribute(\"solari_blue\", \"text\", results[\"Blue\"][\"solari\"])\r\n    UI.setAttribute(\"water_blue\", \"text\", results[\"Blue\"][\"water\"])\r\nend\r\n",
      "LuaScriptState": "",
      "XmlUI": ""
    }
  ]
}
